{"ast":null,"code":"/*global Blob,File*/\n\n/**\n * Module requirements\n */\nvar isArray = require('isarray');\n\nvar isBuf = require('./is-buffer');\n\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' || typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof File === 'function' || typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]';\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function (packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n\n  return {\n    packet: pack,\n    buffers: buffers\n  };\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = {\n      _placeholder: true,\n      num: buffers.length\n    };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n\n    return newData;\n  }\n\n  return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\n\nexports.reconstructPacket = function (packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder) {\n    return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\n\nexports.removeBlobs = function (data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj; // convert any blob\n\n    if (withNativeBlob && obj instanceof Blob || withNativeFile && obj instanceof File) {\n      pendingBlobs++; // async filereader\n\n      var fileReader = new FileReader();\n\n      fileReader.onload = function () {\n        // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        } else {\n          bloblessData = this.result;\n        } // if nothing pending its callback time\n\n\n        if (! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) {\n      // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) {\n      // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n\n  _removeBlobs(bloblessData);\n\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};","map":{"version":3,"names":["isArray","require","isBuf","toString","Object","prototype","withNativeBlob","Blob","call","withNativeFile","File","exports","deconstructPacket","packet","buffers","packetData","data","pack","_deconstructPacket","attachments","length","placeholder","_placeholder","num","push","newData","Array","i","Date","key","reconstructPacket","_reconstructPacket","undefined","removeBlobs","callback","_removeBlobs","obj","curKey","containingObject","pendingBlobs","fileReader","FileReader","onload","result","bloblessData","readAsArrayBuffer"],"sources":["C:/Users/park2020/Desktop/WEB_YBR/frontend_ybr/node_modules/socket.io-parser/binary.js"],"sourcesContent":["/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' || (typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]');\nvar withNativeFile = typeof File === 'function' || (typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]');\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = { _placeholder: true, num: buffers.length };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n    return newData;\n  }\n  return data;\n}\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder) {\n    return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}